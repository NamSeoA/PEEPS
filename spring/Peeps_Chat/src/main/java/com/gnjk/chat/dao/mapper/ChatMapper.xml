<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.gnjk.chat.dao.mapper.ChatMapper">

	 <insert id = "createRoom">
	 	insert into CHATROOM (room_idx, m_idx, rm_idx)
	 	values (#{room_idx}, #{m_idx}, #{rm_idx})
	 </insert>
	 
	<insert id = "insertMessage">
		insert into CHAT(ch_idx, m_idx, rm_idx, ch_time, ch_ms)
		values (#{ch_idx}, #{m_idx}, #{rm_idx}, #{ch_time}, #{ch_ms})
	</insert>
	
	<!-- where 조건에 room_idx 같을때 and 해야하는지 헷갈림... -->
	<select id = "isRoom" resultType = "String">
		select * from CHATROOM WHERE m_idx = #{m_idx}
	</select>
	
	<select id = "getRecentMessage" resultType="String">
		select chat.*, rm_idx from CHAT chat
		where room_idx = #{room_idx} order by ch_idx DESC limit 1
	</select>
	
</mapper>